---
/**
 * Register Page
 *
 * User registration page
 */

import PublicLayout from "@/layouts/PublicLayout.astro";
import { RegisterForm } from "@/components/auth/RegisterForm";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";

// DEV MODE: Always redirect to dashboard
if (import.meta.env.DEV) {
  return Astro.redirect("/dashboard/generate");
}

// PRODUCTION: If user is already logged in, redirect to dashboard
const {
  data: { session },
} = await Astro.locals.supabase.auth.getSession();
if (session?.user) {
  return Astro.redirect("/dashboard/generate");
}
---

<PublicLayout title="Zarejestruj się - 10x-cards" description="Utwórz darmowe konto 10x-cards">
  <div class="container mx-auto px-4 py-16">
    <div class="max-w-md mx-auto">
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold mb-2">Rozpocznij za darmo</h1>
        <p class="text-muted-foreground">Utwórz konto i zacznij naukę z fiszkami AI</p>
      </div>

      <div data-react-root>
        <Card>
          <CardHeader>
            <CardTitle>Rejestracja</CardTitle>
            <CardDescription> Wprowadź swoje dane, aby utworzyć konto </CardDescription>
          </CardHeader>
          <CardContent>
            <RegisterForm client:load />
          </CardContent>
        </Card>
      </div>
    </div>
  </div>
</PublicLayout>
