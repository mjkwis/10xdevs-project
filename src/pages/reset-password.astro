---
/**
 * Reset Password Request Page
 *
 * Page for requesting a password reset link
 */

import PublicLayout from "@/layouts/PublicLayout.astro";
import { ResetPasswordRequestForm } from "@/components/auth/ResetPasswordRequestForm";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";

// DEV MODE: Always redirect to dashboard
if (import.meta.env.DEV) {
  return Astro.redirect("/dashboard/generate");
}

// PRODUCTION: If user is already logged in, redirect to dashboard
const {
  data: { session },
} = await Astro.locals.supabase.auth.getSession();
if (session?.user) {
  return Astro.redirect("/dashboard/generate");
}
---

<PublicLayout title="Resetuj hasło - 10x-cards" description="Zresetuj hasło do swojego konta 10x-cards">
  <div class="container mx-auto px-4 py-16">
    <div class="max-w-md mx-auto">
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold mb-2">Nie pamiętasz hasła?</h1>
        <p class="text-muted-foreground">Wyślemy Ci link do resetowania hasła na Twój adres email</p>
      </div>

      <div data-react-root>
        <Card>
          <CardHeader>
            <CardTitle>Resetowanie hasła</CardTitle>
            <CardDescription> Wprowadź adres email powiązany z Twoim kontem </CardDescription>
          </CardHeader>
          <CardContent>
            <ResetPasswordRequestForm client:load />
          </CardContent>
        </Card>
      </div>
    </div>
  </div>
</PublicLayout>

